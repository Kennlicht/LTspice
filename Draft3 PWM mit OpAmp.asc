Version 4
SHEET 1 1196 680
WIRE -320 -64 -320 -96
WIRE -480 0 -480 -96
WIRE -320 48 -320 16
WIRE 496 96 448 96
WIRE 624 96 576 96
WIRE -240 128 -400 128
WIRE -912 144 -960 144
WIRE -880 144 -912 144
WIRE -768 144 -800 144
WIRE -480 144 -480 80
WIRE -480 144 -576 144
WIRE -112 144 -144 144
WIRE 224 144 192 144
WIRE 720 144 688 144
WIRE 448 192 448 96
WIRE 512 192 448 192
WIRE -912 208 -912 144
WIRE -400 208 -400 128
WIRE -352 208 -400 208
WIRE 624 208 624 96
WIRE 624 208 576 208
WIRE 688 208 688 144
WIRE 688 208 624 208
WIRE 752 208 688 208
WIRE -240 224 -240 128
WIRE -240 224 -288 224
WIRE -144 224 -144 144
WIRE -144 224 -240 224
WIRE -80 224 -144 224
WIRE 32 224 0 224
WIRE 128 224 112 224
WIRE 192 224 192 144
WIRE 192 224 128 224
WIRE 240 224 192 224
WIRE 512 224 320 224
WIRE -768 240 -800 240
WIRE -480 240 -576 240
WIRE -352 240 -480 240
WIRE -480 304 -480 240
WIRE -320 304 -320 256
WIRE 448 304 448 192
WIRE 544 304 544 240
WIRE 128 320 128 224
WIRE -912 368 -912 288
WIRE -800 368 -800 240
WIRE -480 464 -480 384
WIRE 16 464 16 384
WIRE 128 464 128 384
WIRE 448 464 448 384
FLAG -912 368 0
FLAG -320 48 0
FLAG 752 208 0..10V_OUT
IOPIN 752 208 Out
FLAG 128 464 0
FLAG 16 464 0
FLAG -320 192 V+
FLAG -320 -96 V+
FLAG 544 176 V+
FLAG -960 144 PWM_IN
IOPIN -960 144 In
FLAG -800 368 0
FLAG -480 464 0
FLAG -480 -96 V+
FLAG -112 144 PWM_OUT
IOPIN -112 144 Out
FLAG 448 464 0
FLAG 224 144 Vin
IOPIN 224 144 Out
FLAG 720 144 Vout
IOPIN 720 144 Out
FLAG -320 304 0
FLAG 544 304 0
SYMBOL voltage -912 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -31 209 Left 2
SYMATTR Value PULSE(0 {Vcc} 0 1n 1n {x/100*Tpwm} {Tpwm})
SYMATTR InstName V1
SYMBOL voltage -320 -80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL res 16 208 R90
WINDOW 0 8 56 VBottom 2
WINDOW 3 24 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 0
SYMBOL cap 112 320 R0
SYMATTR InstName C2
SYMATTR Value 4µ7
SYMBOL res 336 208 R90
WINDOW 0 8 56 VBottom 2
WINDOW 3 24 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 0
SYMBOL OpAmps\\LM358 544 144 R0
SYMATTR InstName U3
SYMBOL cap 0 320 R0
SYMATTR InstName C1
SYMATTR Value 2µ2
SYMBOL res 128 208 R90
WINDOW 0 8 56 VBottom 2
WINDOW 3 24 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 4k7
SYMBOL OpAmps\\LM358 -320 160 R0
SYMATTR InstName U2
SYMBOL res -784 128 R90
WINDOW 0 8 56 VBottom 2
WINDOW 3 24 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 220
SYMBOL Optos\\PC817C -672 192 R0
SYMATTR InstName U1
SYMBOL res -496 -16 R0
SYMATTR InstName R2
SYMATTR Value 1k2
SYMBOL res -496 288 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 432 288 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 592 80 R90
WINDOW 0 8 56 VBottom 2
WINDOW 3 24 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
TEXT -944 432 Left 2 !.tran 0.1
TEXT -944 488 Left 2 !.step param x list 1 50 99
TEXT -944 464 Left 2 ;PWM Duty Cycle %
TEXT -944 568 Left 2 !.param Vcc = 3.0
TEXT -944 648 Left 2 !.param Tpwm = 1/{Fpwm}
TEXT -944 624 Left 2 !.param Fpwm = 1k
TEXT -944 600 Left 2 ;Frequenz in Hz
TEXT -944 544 Left 2 ;Amplitude in V
TEXT -944 512 Left 2 ;.param x = 10
TEXT -1056 72 Left 2 ;PWM mit beliebieger Amplitude
TEXT -144 72 Left 2 ;PWM mit Amplitude a*V+
TEXT 192 72 Left 2 ;Analogspannung 0..a*V+
TEXT 480 520 Left 2 ;v = 1 + R8 / R9
TEXT -480 520 Left 2 ;a = R3 / (R2+R3+Rx) = ca. 1/2
TEXT -128 520 Left 2 ;ca. 6V
TEXT 200 520 Left 2 ;0..6V
TEXT -728 304 Left 2 ;Fmax = 1kHz
